document.addEventListener('DOMContentLoaded', function() {
    const sourceText = document.getElementById('source-text');
    const sourceLang = document.getElementById('source-lang');
    const targetLang = document.getElementById('target-lang');
    const translatedText = document.getElementById('translated-text');
    const translateBtn = document.getElementById('translate-btn');
    const languageDetected = document.getElementById('language-detected');

    // Language Detection
    sourceText.addEventListener('input', function() {
        if (this.value.trim()) {
            fetch('/detect-language', {
                method: 'POST',
                body: new URLSearchParams({text: this.value})
            })
            .then(response => response.json())
            .then(data => {
                languageDetected.textContent = 
                    data.language ? `Detected Language: ${data.language}` : '';
            });
        }
    });

    // Translation
    translateBtn.addEventListener('click', function() {
        const text = sourceText.value.trim();
        if (!text) {
            alert('Please enter text to translate');
            return;
        }
        
        fetch('/translate', {
            method: 'POST',
            body: new URLSearchParams({
                text: text,
                source_lang: sourceLang.value,
                target_lang: targetLang.value
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.translated_text) {
                translatedText.value = data.translated_text;
            } else {
                translatedText.value = 'Translation failed';
            }
        })
        .catch(error => {
            translatedText.value = 'An error occurred';
            console.error('Translation error:', error);
        });
    });
});